---
title: "R Notebook"
output: html_notebook
---

I will be analysing a Heart Disease dataset.

The data contains 296 observations. The columns are as described below:

* age;
* sex:
  * 0 -> female
  * 1 -> male
* cp - Chest pain type:
  * 0 -> asymptomatic
  * 1 -> angina (chest pain due to not enough blood flow to the heart muscle)
  * 2 -> pain without relation to angina
  * 3 -> typical angina
* trestbps - Resting blood pressure in millimeters of mercury (mm Hg);
* chol - Cholesterol level in mg/dl;
* fbs - level of sugar in the blood is higher than 120 mg/dl or not:
  * 0 -> no
  * 1 -> yes
* restecg - Results of the electrocardiogram on rest:
  * 0: probable left ventricular hypertrophy
  * 1: normal
  * 2: abnormalities in the T wave or ST segment
* thalach - Maxium heart rate during the stress test;
* exang - If patient had angina during exercise:
  * 0 -> no
  * 1 -> yes
* oldpeak - Decrease of the ST segment during exercise according to the same one on rest;
* slope - Slope of the ST segment during the most demanding part of the exercise:
  * 0 -> descending
  * 1 -> flat
  * 2 -> ascending
* ca - Number of main blood vessels that are narrow, coloured by the radioactive dye;
* thal - Results of the blood flow observed via the radioactive dye;
  * 1 -> fixed defect (no blood flow in some part of the heart)
  * 2 -> normal blood flow
  * 3 -> reversible defect (a blood flow is observed but it is not normal)
* target - If patient has heart disease:
  * 0 -> yes
  * 1 -> no

```{r}
# Read the dataset into variable
df = read.csv('heart.csv')
```
\

## Question 1

### a) Describe the dataset using appropriate plots/curves/charts

```{r}

target_tb = table(df$target)

barp <- barplot(
  target_tb,
  col = c("#2CA02C", "#D62728"),
  xlab = "Disease in patient",
  ylab = "Number of Patients",
  names.arg = c("no", "yes"),
  ylim = c(0, 180)
)
text(barp, target_tb + 10,target_tb,cex=0.8)

hist(
  df$age,
  main = "Age Distribution",
  xlab = "Age",
  ylab = "Number of Patients",
  col = "grey"
)

boxplot(
  df$trestbps,
  main = "Resting blood pressure in millimeters of mercury (mm Hg)",
  horizontal = TRUE
)

plot(
  main = "Resting blood pressure",
  x = df$age,
  xlab = "Age",
  y = df$trestbps,
  ylab = "BP (mm Hg)"
)

#add linear trend
abline(lm(df$trestbps ~ df$age)) 

boxplot(
  df$chol,
  main = "Cholesterol level in mg/dl",
  horizontal = TRUE
)

plot(
  main = "Cholesterol level",
  x = df$age,
  xlab = "Age",
  y = df$chol,
  ylab = "Cholesterol level (mg/dl)",
  ylim = c(0, 600)
)

#add linear trend
abline(lm(df$chol ~ df$age)) 
```

As shown in the graphs above, the dataset contains a balanced number of observations between patients with and without heart disease. These patients' age are mainly between 40 and 70 years old, which is the typical age that heart disease starts to show(1).

\  

### b) Consider one of continuous attributes, and compute central and variational measures

Continuous Attribute chosen: 
**"Resting blood pressure in millimeters of mercury (mm Hg)"** \
\

```{r}
# Declaring all measures
att = df$trestbps
att_mean = mean(att)
att_median = median(att)
att_sd = sd(att)
att_max = max(att)
att_min = min(att)
att_range = att_max - att_min
```

```{r}
paste0("Mean: ", format(att_mean, digits = 3, nsmall = 2))
```
```{r}
paste0("Median: ", att_median)
```

With the `mean > median`, we can say that the data has a rightward skewness. That is confirmed by the graphs below:

``` {r}
hist(
  att,
  main = "Blood Pressure Distribution",
  xlab = "BP (mm Hg)",
  ylab = "Number of Patients",
  col = "grey"
)

plot(
  density(att),
  main = "Blood Pressure Density",
)

```

```{r}
paste0(
  "Average ",
  format(att_mean, digits = 3, nsmall = 2),
  " +- SD ",
  format(att_sd, digits = 3, nsmall = 2), sep=""
)
```
```{r}
paste0("Max Value: ", att_max, " - Min Value: ", att_min, " - Range: ", att_range)
```

### c) Chebyshev's rule with one-sigma interval. Based on your proposed interval, specify the outliers if any


\  


(1): Institute of Medicine (US) Committee on Preventing the Global Epidemic of Cardiovascular Disease: Meeting the Challenges in Developing Countries; Fuster V, Kelly BB, editors. Promoting Cardiovascular Health in the Developing World: A Critical Challenge to Achieve Global Health. Washington (DC): National Academies Press (US); 2010. 2, Epidemiology of Cardiovascular Disease. Available from: https://www.ncbi.nlm.nih.gov/books/NBK45688/